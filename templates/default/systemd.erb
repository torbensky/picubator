[Unit]
Description=Service for controlling/monitoring an incubator using a Raspberry Pi
Wants=network-online.target
After=network-online.target

[Service]
Environment="PICUBATOR_NOOP_DAEMON=<%= node['picubator']['noop_daemon'] %>"
Environment="PICUBATOR_CONFIG=<%= node['picubator']['config_dir'] %>config.json"
<% if node['picubator']['noop_daemon'] == 'ON' %>
ExecStart=/usr/bin/python <%= node['picubator']['app_root'] %>/picubator/systemd.py noop
<% else %>
ExecStart=/usr/bin/python <%= node['picubator']['app_root'] %>/picubator/systemd.py
<% end %>
Restart=on-failure
# Note that we use Type=notify here since systemd.py will send "READY=1" after initialization is complete
Type=notify

[Install]
WantedBy=multi-user.target
